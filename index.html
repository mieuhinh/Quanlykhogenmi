<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản Lý Kho Đa Kho</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; padding-top: 20px; }
        .card { box-shadow: 0 4px 6px rgba(0,0,0,0.1); border: none; }
        .status-badge { font-size: 0.8rem; }
    </style>
</head>
<body>
    <div class="container">
        <h2 class="text-center mb-4 text-primary">Hệ Thống Quản Lý Kho</h2>

        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">Giao Dịch Kho</h5>
                <form id="warehouseForm" class="row g-3">
                    <div class="col-md-3">
                        <label class="form-label">Mã Hàng</label>
                        <input type="text" id="itemId" class="form-control" placeholder="VD: AO-01" required>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">Chọn Kho</label>
                        <select id="warehouseId" class="form-select">
                            <option value="KHO-A">Kho Cơ Sở A</option>
                            <option value="KHO-B">Kho Cơ Sở B</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <label class="form-label">Loại</label>
                        <select id="type" class="form-select">
                            <option value="NHAP">Nhập Kho</option>
                            <option value="XUAT">Xuất Kho</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <label class="form-label">Số Lượng</label>
                        <input type="number" id="quantity" class="form-control" min="1" required>
                    </div>
                    <div class="col-md-2 d-flex align-items-end">
                        <button type="submit" class="btn btn-primary w-100">Cập Nhật</button>
                    </div>
                </form>
            </div>
        </div>

        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Tồn Kho Hiện Tại</h5>
                <div class="table-responsive">
                    <table class="table table-hover mt-3">
                        <thead class="table-dark">
                            <tr>
                                <th>Mã Hàng</th>
                                <th>Kho</th>
                                <th>Số Lượng Tồn</th>
                                <th>Trạng Thái</th>
                            </tr>
                        </thead>
                        <tbody id="inventoryBody">
                            </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Cấu hình URL Google Apps Script của bạn tại đây
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzlvmn5-Fu1LJ9cSn5-KWBZQO3H4Kg9elMXbi_4P3lpDYlK6ddchjcLa7Ucfcti08lRwg/exec";

        document.getElementById('warehouseForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const data = {
                maHang: document.getElementById('itemId').value,
                maKho: document.getElementById('warehouseId').value,
                loai: document.getElementById('type').value,
                soLuong: document.getElementById('quantity').value
            };

            // Hiệu ứng chờ khi gửi dữ liệu
            const btn = e.target.querySelector('button');
            btn.disabled = true;
            btn.innerText = "Đang gửi...";

            fetch(SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors', // Quan trọng khi dùng Google Script
                body: JSON.stringify(data)
            }).then(() => {
                alert("Đã ghi nhận giao dịch thành công!");
                btn.disabled = false;
                btn.innerText = "Cập Nhật";
                e.target.reset();
            }).catch(err => {
                console.error(err);
                alert("Có lỗi xảy ra!");
            });
        });
    </script>
</body>
</html>
